<!DOCTYPE html>
<html lang="en" data-theme="light" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <title>Join Us | Sawaed Membership</title>
    <meta name="description" content="Register for Sawaed Initiative Membership">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Roboto+Mono:wght@400;500;700&family=Teko:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* --- 1. CSS VARIABLES & RESET --- */
        :root {
            --primary-red: #9A1F1F;       
            --engineering-slate: #2c3e50; 
            --tech-blue: #3498db;         
            --bg-body: #f4f6f8;           
            --text-main: #0f172a;         
            --text-muted: #64748b;
            --card-bg: #ffffff;
            --card-border: #cbd5e1;       
            --border-radius: 4px;         
            --grid-color: rgba(44, 62, 80, 0.05);
            --cursor-color: #9A1F1F;
            --canvas-node: rgba(44, 62, 80, 0.6);
            --canvas-line: rgba(44, 62, 80, 0.15);
            --success-green: #27c93f;
        }

        html[data-theme="dark"] {
            --bg-body: #0b1120;           
            --text-main: #f1f5f9;
            --text-muted: #94a3b8;
            --card-bg: #1e293b;
            --card-border: #334155;
            --grid-color: rgba(255,255,255,0.03);
            --cursor-color: #ffffff;
            --canvas-node: rgba(255, 255, 255, 0.4);
            --canvas-line: rgba(255, 255, 255, 0.08);
        }

        /* BLIND MODE FIXES */
        html.blind-mode {
            --primary-red: #000000 !important;
            --bg-body: #ffffff !important;
            --text-main: #000000 !important;
            --text-muted: #000000 !important;
            --card-bg: #ffffff !important;
            --card-border: #000000 !important;
            --grid-color: transparent !important;
            --canvas-display: none;
            --cursor-color: #000000 !important;
        }
        
        html[data-theme="dark"].blind-mode {
            --primary-red: #ffffff !important;
            --bg-body: #000000 !important;
            --text-main: #ffffff !important;
            --text-muted: #ffffff !important;
            --card-bg: #000000 !important;
            --card-border: #ffffff !important;
            --cursor-color: #ffffff !important;
        }

        html[data-theme="dark"].blind-mode .submit-btn,
        html[data-theme="dark"].blind-mode .nav-link.join-btn,
        html[data-theme="dark"].blind-mode .nav-btn.active {
            color: #000000 !important;
            font-weight: 800;
        }
        
        html.blind-mode .checkbox-wrapper {
            background: transparent !important;
            border: 2px solid var(--text-main) !important;
        }

        html, body {
            margin: 0; padding: 0;
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-body);
            color: var(--text-main);
            overflow-x: hidden;
            width: 100%;
            transition: background-color 0.5s ease, color 0.5s ease;
            background-image: 
                linear-gradient(var(--grid-color) 1px, transparent 1px),
                linear-gradient(90deg, var(--grid-color) 1px, transparent 1px);
            background-size: 30px 30px;
        }
        * { box-sizing: border-box; }

        h1, h2, h3, h4 { font-family: 'Teko', sans-serif; text-transform: uppercase; letter-spacing: 0.5px; }
        .tech-font { font-family: 'Roboto Mono', monospace; letter-spacing: -0.5px; }
        
        /* --- CUSTOM CURSOR (SQUARE) --- */
        @media (hover: hover) {
            * { cursor: none !important; } /* Hide default cursor */
            input, select, textarea { cursor: text !important; }
            a, button, .btn, .hover-trigger, .checkbox-container, .checkbox-container label, .checkbox-container input, .custom-option { cursor: pointer !important; }

            #cursor-dot {
                position: fixed; top: 0; left: 0; width: 8px; height: 8px; 
                background-color: var(--cursor-color);
                pointer-events: none; z-index: 999999;
                transform: translate(-50%, -50%);
                transition: opacity 0.2s;
            }
            body.hover-active #cursor-dot { opacity: 0.4; width: 12px; height: 12px; }
        }

        /* --- BACKGROUND CANVAS --- */
        #engineering-canvas {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: -2; pointer-events: none; display: var(--canvas-display, block);
        }

        /* --- NAVIGATION --- */
        nav {
            display: flex; justify-content: space-between; align-items: center;
            padding: 1rem 5%; position: fixed; top: 0; width: 100%; z-index: 1000;
            background: rgba(255,255,255,0.8); backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--card-border);
            transition: all 0.3s ease;
        }
        html[data-theme="dark"] nav { background: rgba(11, 17, 32, 0.8); }
        html.blind-mode nav { background: var(--bg-body); border-bottom: 2px solid var(--card-border); }
        
        .logo { display: flex; align-items: center; gap: 12px; font-weight: 600; font-size: 1.5rem; font-family: 'Teko', sans-serif; letter-spacing: 1px; cursor: pointer; }
        .logo img { height: 40px; width: auto; transition: filter 0.3s; }
        html[data-theme="dark"] .logo img { filter: none; }
        html.blind-mode .logo img { filter: grayscale(100%) contrast(200%); }

        .nav-menu { display: flex; gap: 25px; align-items: center; }
        .nav-link {
            text-decoration: none; color: var(--text-main);
            font-family: 'Roboto Mono', monospace; font-weight: 600; font-size: 0.8rem;
            text-transform: uppercase; transition: color 0.2s;
        }
        .nav-link:hover { color: var(--primary-red); }
        
        .nav-link.join-btn {
            background: var(--primary-red); color: #fff;
            padding: 6px 16px; border-radius: var(--border-radius);
            border: 1px solid var(--primary-red);
        }

        .nav-controls { display: flex; gap: 8px; }
        .nav-btn {
            background: transparent; 
            border: 1px solid var(--card-border); 
            color: var(--text-main); padding: 8px 14px; 
            border-radius: var(--border-radius); 
            font-size: 0.75rem; font-weight: 600; cursor: pointer; 
            display: flex; align-items: center; gap: 6px; font-family: 'Roboto Mono', monospace;
        }
        .nav-btn.active { background: var(--primary-red); color: white; border-color: var(--primary-red); }

        /* --- FORM STYLES --- */
        .article-hero { padding: 8rem 5% 3rem; text-align: center; }
        .article-title {
            font-size: clamp(2.5rem, 6vw, 4.5rem); line-height: 0.95; color: var(--text-main);
            margin-bottom: 1.5rem; max-width: 1000px; margin-left: auto; margin-right: auto;
        }
        .article-subtitle {
            font-family: 'Inter'; font-size: 1.2rem; color: var(--text-muted);
            max-width: 700px; margin: 0 auto 3rem; font-weight: 300;
        }

        .form-container {
            max-width: 700px; margin: 0 auto; padding: 0 5% 6rem;
            min-height: 50vh;
        }

        .form-grid {
            display: grid; grid-template-columns: 1fr 1fr; gap: 20px;
        }
        .form-group { margin-bottom: 20px; position: relative; }
        .form-group.full-width { grid-column: span 2; }

        .form-label {
            display: block; font-family: 'Roboto Mono', monospace; 
            font-size: 0.75rem; color: var(--text-muted); 
            margin-bottom: 8px; text-transform: uppercase; letter-spacing: 1px;
        }

        .form-input, .form-select {
            width: 100%; padding: 12px 15px;
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: var(--border-radius);
            color: var(--text-main);
            font-family: 'Inter', sans-serif; font-size: 1rem;
            transition: 0.3s;
            appearance: none;
        }
        
        .form-input:focus, .form-select:focus {
            outline: none; border-color: var(--primary-red);
            box-shadow: 0 0 0 3px rgba(154, 31, 31, 0.1);
        }

        /* --- CUSTOM SEARCHABLE DROPDOWN --- */
        .search-dropdown-container {
            position: relative;
        }
        .dropdown-options-list {
            position: absolute;
            top: 100%; left: 0; width: 100%;
            max-height: 250px;
            overflow-y: auto;
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-top: none;
            border-radius: 0 0 4px 4px;
            z-index: 99;
            display: none;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        .dropdown-options-list.show { display: block; }
        .custom-option {
            padding: 10px 15px;
            cursor: pointer;
            border-bottom: 1px solid var(--grid-color);
            transition: background 0.2s;
            color: var(--text-main);
        }
        .custom-option:hover { background: rgba(154, 31, 31, 0.05); color: var(--primary-red); }
        .custom-option.hidden { display: none; }

        .select-wrapper { position: relative; }
        .select-wrapper::after {
            content: 'â–¼'; font-size: 0.7rem; color: var(--text-muted);
            position: absolute; right: 15px; top: 50%; transform: translateY(-50%);
            pointer-events: none;
        }

        /* --- PDF WINDOW --- */
        .pdf-viewer-window {
            background: var(--engineering-slate);
            border-radius: var(--border-radius);
            padding: 10px;
            margin-top: 20px;
            box-shadow: 0 10px 30px -10px rgba(0,0,0,0.3);
            display: flex; flex-direction: column; height: 500px;
        }
        .window-header {
            display: flex; gap: 6px; padding-bottom: 10px; padding-left: 5px; flex-shrink: 0;
        }
        .dot { width: 10px; height: 10px; border-radius: 50%; background: #ff5f56; }
        .dot:nth-child(2) { background: #ffbd2e; }
        .dot:nth-child(3) { background: #27c93f; }
        
        .pdf-scroll-wrapper {
            flex-grow: 1; width: 100%; height: 100%;
            overflow-y: auto; -webkit-overflow-scrolling: touch;
            background: #fff;
        }
        .pdf-frame {
            width: 100%; height: 100%; border: none; background: #fff;
            border-radius: 2px; display: block;
        }

        .disclaimer-box {
            background: var(--card-bg); border: 1px solid var(--card-border);
            padding: 1.5rem; margin-top: 2rem; border-left: 3px solid var(--primary-red);
        }
        .disclaimer-text { font-size: 0.9rem; color: var(--text-muted); line-height: 1.5; }

        .checkbox-wrapper {
            display: flex; align-items: flex-start; gap: 12px; margin-top: 25px;
            padding: 15px; background: rgba(154, 31, 31, 0.05);
            border-radius: var(--border-radius); border: 1px solid rgba(154, 31, 31, 0.2);
            transition: 0.3s;
        }
        .checkbox-wrapper input[type="checkbox"] {
            width: 20px; height: 20px; flex-shrink: 0; margin-top: 2px; accent-color: var(--primary-red); cursor: pointer;
        }
        .checkbox-wrapper label {
            font-size: 0.95rem; line-height: 1.4; color: var(--text-main); font-weight: 500; cursor: pointer;
        }

        .submit-btn {
            background: var(--primary-red); color: white;
            border: none; width: 100%; padding: 15px;
            font-family: 'Teko', sans-serif; font-size: 1.5rem; letter-spacing: 1px;
            margin-top: 2.5rem; /* Increased margin to separate from checkbox */
            margin-bottom: 1rem;
            border-radius: var(--border-radius);
            cursor: pointer; transition: 0.3s;
        }
        .submit-btn:disabled { background: var(--text-muted); cursor: not-allowed; }
        .submit-btn:hover:not(:disabled) { background: #b92525; transform: translateY(-2px); }

        .success-state {
            display: none; text-align: center; padding: 4rem 2rem;
            background: var(--card-bg); border: 1px solid var(--card-border);
            border-radius: var(--border-radius); border-top: 4px solid var(--success-green);
        }
        .success-icon {
            font-size: 4rem; color: var(--success-green); margin-bottom: 1.5rem;
        }

        .mobile-pdf-link {
            display: none; text-align: center; margin-top: 10px;
        }
        .mobile-pdf-link a {
            color: var(--text-main); font-size: 0.8rem; text-decoration: underline;
        }

        footer { 
            border-top: 1px solid var(--card-border); 
            padding: 4rem 5%; text-align: center; margin-top: 0rem; 
            background: var(--bg-body);
        }
        .social-links { display: flex; justify-content: center; gap: 15px; margin-bottom: 25px; }
        .social-links a {
            width: 40px; height: 40px; border: 1px solid var(--text-muted);
            display: flex; align-items: center; justify-content: center;
            color: var(--text-muted); text-decoration: none; transition: 0.3s;
        }
        .social-links a:hover { background: var(--text-main); color: var(--bg-body); border-color: var(--text-main); }

        @media (max-width: 768px) {
            .nav-menu { display: none; }
            .form-grid { grid-template-columns: 1fr; }
            .form-group.full-width { grid-column: span 1; }
            .article-title { font-size: 2.5rem; }
            .mobile-pdf-link { display: block; }
            /* Fix mobile layout spacing */
            .form-container { padding-bottom: 4rem; } 
            .submit-btn { margin-top: 3rem; }
        }
    </style>
</head>
<body>

    <div id="cursor-dot"></div>
    <canvas id="engineering-canvas"></canvas>

    <nav>
        <div class="logo hover-trigger magnetic" onclick="window.location.href='https://sawaed-om.org/'">
            <img src="logo.png" alt="Sawaed Logo">
            <span></span>
        </div>
        <div class="nav-menu">
            <a href="https://sawaed-om.org/" class="nav-link hover-trigger">Home</a>
            <a href="https://sawaed-om.org/join-us" class="nav-link join-btn hover-trigger magnetic">Join Us</a>
        </div>
        <div class="nav-controls">
            <button class="nav-btn hover-trigger magnetic" onclick="toggleTheme()" id="themeBtn">
                <i class="fas fa-moon"></i> <span>DARK</span>
            </button>
            <button class="nav-btn hover-trigger magnetic" onclick="toggleBlindMode()" id="blindBtn">
                <i class="fas fa-eye"></i> <span>CONTRAST</span>
            </button>
        </div>
    </nav>

    <header class="article-hero">
        <div class="gsap-hero">
            <span style="font-family: 'Roboto Mono'; color: var(--primary-red); text-transform: uppercase; letter-spacing: 2px;">Membership Registration</span>
        </div>
        <h1 class="article-title gsap-hero">Join The Community</h1>
        <p class="article-subtitle gsap-hero">Be part of the premier network for Omani engineering students in the UK.</p>
    </header>

    <div class="form-container gsap-reveal">
        
        <div id="successMessage" class="success-state">
            <div class="success-icon"><i class="fas fa-check-circle"></i></div>
            <h2 style="font-size: 2.5rem; margin-bottom: 10px; color: var(--text-main);">Registration Submitted</h2>
            <p style="color: var(--text-muted); font-size: 1.1rem; max-width: 500px; margin: 0 auto 2rem;">
                Thank you! We have received your details
            </p>
            <button onclick="window.location.href='https://sawaed-om.org/'" class="nav-btn hover-trigger" style="margin: 0 auto; background: var(--text-main); color: var(--bg-body);">
                RETURN HOME
            </button>
        </div>

        <form id="joinForm" action="#" onsubmit="submitForm(event)">
            
            <div class="form-grid">
                <div class="form-group full-width">
                    <label class="form-label">Full Name</label>
                    <input type="text" id="fullName" class="form-input hover-trigger" required placeholder="Enter your full name">
                </div>

                <div class="form-group">
                    <label class="form-label">Personal Email</label>
                    <div class="search-dropdown-container">
                        <input type="email" id="email" class="form-input hover-trigger" placeholder="name@example.com" onkeyup="handleEmailInput(this)" autocomplete="off" required>
                        <div id="emailList" class="dropdown-options-list">
                            </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">WhatsApp Number</label>
                    <input type="tel" id="phone" class="form-input hover-trigger" required placeholder="+44 7123 456789">
                </div>

                <div class="form-group">
                    <label class="form-label">City in UK</label>
                    <div class="search-dropdown-container">
                        <input type="text" class="form-input hover-trigger" id="cityInput" placeholder="Search city..." onkeyup="filterDropdown('cityInput', 'cityList')" onfocus="showDropdown('cityList')" autocomplete="off" required>
                        <div id="cityList" class="dropdown-options-list">
                            </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">University</label>
                    <div class="search-dropdown-container">
                        <input type="text" class="form-input hover-trigger" id="uniInput" placeholder="Search university..." onkeyup="filterDropdown('uniInput', 'uniList')" onfocus="showDropdown('uniList')" autocomplete="off" required>
                        <div id="uniList" class="dropdown-options-list">
                            </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Degree Type</label>
                    <div class="select-wrapper">
                        <select id="degree" class="form-select hover-trigger" required>
                            <option value="" disabled selected>Select Degree</option>
                            <option value="B.Eng">B.Eng (Bachelor of Engineering)</option>
                            <option value="B.Sc">B.Sc (Bachelor of Science)</option>
                            <option value="M.Eng">M.Eng (Master of Engineering)</option>
                            <option value="M.Sc">M.Sc (Master of Science)</option>
                            <option value="PhD">PhD</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Academic Year</label>
                    <div class="select-wrapper">
                        <select id="year" class="form-select hover-trigger" required>
                            <option value="" disabled selected>Select Year</option>
                            <option value="Foundation">Foundation Year</option>
                            <option value="Year 1">Year 1</option>
                            <option value="Year 2">Year 2</option>
                            <option value="Year 3">Year 3</option>
                            <option value="Year 4">Year 4</option>
                            <option value="Year 5">Year 5</option>
                            <option value="PhD">PhD Researcher</option>
                        </select>
                    </div>
                </div>

                <div class="form-group full-width">
                    <label class="form-label">Engineering Discipline</label>
                    <input type="text" id="discipline" class="form-input hover-trigger" required placeholder="e.g. Mechanical, Chemical, Civil...">
                </div>
            </div>

            <div class="disclaimer-box gsap-reveal">
                <p class="disclaimer-text">
                    By registering for membership in the initiative, you acknowledge that you have read and agree to all the terms and conditions outlined in the initiative's bylaws.
                </p>
                <p class="disclaimer-text" style="font-weight: 600;">You can view the bylaws below:</p>
                
                <div class="pdf-viewer-window">
                    <div class="window-header">
                        <div class="dot"></div><div class="dot"></div><div class="dot"></div>
                    </div>
                    <div class="pdf-scroll-wrapper">
                        <embed src="SAWAED - Regulations.pdf" type="application/pdf" class="pdf-frame">
                    </div>
                </div>

                <div class="mobile-pdf-link">
                    <a href="SAWAED - Regulations.pdf" target="_blank"><i class="fas fa-external-link-alt"></i> Tap here to open PDF in new tab</a>
                </div>

                <div class="checkbox-wrapper hover-trigger">
                    <input type="checkbox" id="agreeRegulations" name="agreeRegulations" required>
                    <label for="agreeRegulations">
                        I confirm that I have read, understood, and agree to the <strong>Sawaed Initiative Regulations</strong>.
                    </label>
                </div>
            </div>

            <button type="submit" class="submit-btn hover-trigger magnetic">CONFIRM REGISTRATION</button>
        </form>
    </div>

    <footer>
        <div class="logo" style="justify-content:center; margin-bottom:20px;">
            <img src="logo.png" style="height:40px;">
        </div>
        <div class="social-links">
            <a href="https://www.linkedin.com/company/sawaedoman" class="hover-trigger magnetic"><i class="fab fa-linkedin-in"></i></a>
            <a href="https://www.instagram.com/sawaed.om/" class="hover-trigger magnetic"><i class="fab fa-instagram"></i></a>
            <a href="mailto:info@sawaed-om.org" class="hover-trigger magnetic"><i class="fas fa-envelope"></i></a>
        </div>
        <p style="color:var(--text-muted); font-size:0.8rem; font-family: 'Roboto Mono';">&copy; 2026 Sawaed Initiative. All Rights Reserved.</p>
    </footer>

    <script>
        /* --- DATA: FULL A-Z LISTS --- */
        const cities = [
            "Aberdeen", "Armagh", "Bangor (Northern Ireland)", "Bangor (Wales)", "Bath", "Belfast", "Birmingham", "Bradford", "Brighton & Hove", "Bristol", 
            "Cambridge", "Canterbury", "Cardiff", "Carlisle", "Chelmsford", "Chester", "Chichester", "City of Gibraltar", "Colchester", "Coventry", 
            "Derby", "Doncaster", "Douglas (Isle of Man)", "Dundee", "Dunfermline", "Durham", "Edinburgh", "Ely", "Exeter", "Glasgow", 
            "Gloucester", "Hamilton (Bermuda)", "Hereford", "Inverness", "Jamestown (Saint Helena)", "Kingston-upon-Hull", "Lancaster", "Leeds", "Leicester", "Lichfield", 
            "Lincoln", "Lisburn", "Liverpool", "London", "Londonderry", "Manchester", "Milton Keynes", "Newcastle-upon-Tyne", "Newport", "Newry", 
            "Norwich", "Nottingham", "Oxford", "Perth", "Peterborough", "Plymouth", "Portsmouth", "Preston", "Ripon", "Salford", 
            "Salisbury", "Sheffield", "Southampton", "Southend-on-Sea", "St Albans", "St Asaph", "St Davids", "Stanley (Falkland Islands)", "Stirling", "Stoke on Trent", 
            "Sunderland", "Swansea", "Truro", "Wakefield", "Wells", "Westminster", "Winchester", "Wolverhampton", "Worcester", "Wrexham", "York"
        ];

        const universities = [
            "Abertay University", "Aberystwyth University", "Anglia Ruskin University", "Arts University Bournemouth", "Aston University", "Bangor University", "Bath Spa University", "Birkbeck, University of London", "Birmingham City University", "Birmingham Newman University", 
            "Bishop Grosseteste University", "Bournemouth University", "BPP University", "Brunel University London", "Buckinghamshire New University", "Canterbury Christ Church University", "Cardiff Metropolitan University", "Cardiff University", "City, University of London", "Coventry University", 
            "Cranfield University", "De Montfort University", "Durham University", "Edge Hill University", "Edinburgh Napier University", "Falmouth University", "Glasgow Caledonian University", "Goldsmiths, University of London", "Guildhall School of Music and Drama", "Harper Adams University", 
            "Hartpury University", "Heriot-Watt University", "Imperial College London", "Keele University", "King's College London", "Kingston University", "Lancaster University", "Leeds Arts University", "Leeds Beckett University", "Leeds Conservatoire", 
            "Leeds Trinity University", "Liverpool Hope University", "Liverpool John Moores University", "London Business School", "London Metropolitan University", "London School of Economics and Political Science (LSE)", "London School of Hygiene and Tropical Medicine", "London South Bank University", "Loughborough University", "Manchester Metropolitan University", 
            "Middlesex University", "Newcastle University", "Northumbria University", "Norwich University of the Arts", "Nottingham Trent University", "Oxford Brookes University", "Plymouth Marjon University", "Queen Margaret University", "Queen Mary University of London", "Queen's University Belfast", 
            "Ravensbourne University London", "Regent's University London", "Richmond, The American International University in London", "Robert Gordon University", "Rose Bruford College", "Royal Academy of Music", "Royal Agricultural University", "Royal Central School of Speech and Drama", "Royal College of Art", "Royal College of Music", 
            "Royal Conservatoire of Scotland", "Royal Holloway, University of London", "Royal Northern College of Music", "Royal Veterinary College", "Sheffield Hallam University", "SOAS University of London", "Solent University", "St George's, University of London", "St Mary's University, Twickenham", 
            "Staffordshire University", "Swansea University", "Teesside University", "The Courtauld Institute of Art", "The Open University", "Trinity Laban Conservatoire of Music and Dance", "Ulster University", "University College Birmingham", "University College London (UCL)", "University for the Creative Arts", 
            "University of Aberdeen", "University of Bath", "University of Bedfordshire", "University of Birmingham", "University of Bolton", "University of Bradford", "University of Brighton", "University of Bristol", "University of Buckingham", "University of Cambridge", 
            "University of Central Lancashire", "University of Chester", "University of Chichester", "University of Cumbria", "University of Derby", "University of Dundee", "University of East Anglia (UEA)", "University of East London", "University of Edinburgh", "University of Essex", 
            "University of Exeter", "University of Glasgow", "University of Gloucestershire", "University of Greenwich", "University of Hertfordshire", "University of Huddersfield", "University of Hull", "University of Kent", "University of Leeds", "University of Leicester", 
            "University of Lincoln", "University of Liverpool", "University of Manchester", "University of Northampton", "University of Nottingham", "University of Oxford", "University of Plymouth", "University of Portsmouth", "University of Reading", "University of Roehampton", 
            "University of Salford", "University of Sheffield", "University of South Wales", "University of Southampton", "University of St Andrews", "University of Stirling", "University of Strathclyde", "University of Suffolk", "University of Sunderland", "University of Surrey", 
            "University of Sussex", "University of the Arts London", "University of the Highlands and Islands", "University of the West of England (UWE Bristol)", "University of the West of Scotland", "University of Wales Trinity Saint David", "University of Warwick", "University of West London", "University of Westminster", "University of Winchester", 
            "University of Wolverhampton", "University of Worcester", "University of York", "Wrexham University", "York St John University"
        ];

        /* --- LOGIC: SEARCH DROPDOWNS --- */
        function populateDropdown(listId, data, inputId) {
            const list = document.getElementById(listId);
            const input = document.getElementById(inputId);
            list.innerHTML = '';
            data.forEach(item => {
                const div = document.createElement('div');
                div.className = 'custom-option';
                div.textContent = item;
                div.onclick = () => {
                    input.value = item;
                    list.classList.remove('show');
                };
                list.appendChild(div);
            });
        }

        function filterDropdown(inputId, listId) {
            const input = document.getElementById(inputId);
            const filter = input.value.toUpperCase();
            const list = document.getElementById(listId);
            const options = list.getElementsByClassName('custom-option');
            list.classList.add('show');
            for (let i = 0; i < options.length; i++) {
                const txtValue = options[i].textContent || options[i].innerText;
                if (txtValue.toUpperCase().indexOf(filter) > -1) {
                    options[i].classList.remove('hidden');
                } else {
                    options[i].classList.add('hidden');
                }
            }
        }

        /* --- LOGIC: SMART EMAIL SUGGESTIONS --- */
        function handleEmailInput(input) {
            const list = document.getElementById('emailList');
            const val = input.value;
            const domains = ["gmail.com", "outlook.com", "hotmail.com", "icloud.com", "yahoo.com"];
            
            // Only show suggestions if user typed '@'
            if (val.includes('@')) {
                const parts = val.split('@');
                const username = parts[0];
                const domainPart = parts[1]; // what they typed after @

                list.innerHTML = '';
                
                // Filter domains based on what user typed after @
                const filteredDomains = domains.filter(d => d.startsWith(domainPart));
                
                if (filteredDomains.length > 0) {
                    filteredDomains.forEach(domain => {
                        const div = document.createElement('div');
                        div.className = 'custom-option';
                        div.textContent = username + '@' + domain;
                        div.onclick = () => {
                            input.value = username + '@' + domain;
                            list.classList.remove('show');
                        };
                        list.appendChild(div);
                    });
                    list.classList.add('show');
                } else {
                    list.classList.remove('show');
                }
            } else {
                list.classList.remove('show');
            }
        }

        function showDropdown(listId) {
            document.getElementById(listId).classList.add('show');
        }

        document.addEventListener('click', function(e) {
            if (!e.target.closest('.search-dropdown-container')) {
                document.querySelectorAll('.dropdown-options-list').forEach(el => el.classList.remove('show'));
            }
        });

        /* --- INITIALIZATION --- */
        window.addEventListener('load', () => {
            populateDropdown('cityList', cities, 'cityInput');
            populateDropdown('uniList', universities, 'uniInput');
            gsap.from(".gsap-hero", { y: 40, opacity: 0, duration: 1, stagger: 0.15, ease: "power3.out" });
        });

        /* --- FORM SUBMISSION (WITH SHEETS) --- */
        function submitForm(e) {
            e.preventDefault();
            
            // 1. Validate Checkbox
            const checkbox = document.getElementById('agreeRegulations');
            if(!checkbox.checked) {
                alert("Please agree to the regulations to proceed.");
                return;
            }

            // 2. Set "Processing" State
            const btn = e.target.querySelector('button[type="submit"]');
            const originalText = btn.innerText;
            btn.innerText = "PROCESSING...";
            btn.disabled = true;
            btn.style.cursor = "wait";

            // 3. Prepare Data for Google Sheets
            const formData = {
                fullName: document.getElementById('fullName').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value,
                city: document.getElementById('cityInput').value,
                university: document.getElementById('uniInput').value,
                degree: document.getElementById('degree').value, 
                year: document.getElementById('year').value,   
                discipline: document.getElementById('discipline').value
            };

            // 4. Send Data
            // *** Your Google Script Web App URL ***
            const scriptURL = 'https://script.google.com/macros/s/AKfycbxzL6Nwo2QUd8of-ko_OATX077BS9sQtY53NKU589O2mwphh7RUaHVnXs3nea8Ki_TI/exec';

            fetch(scriptURL, {
                method: 'POST',
                body: JSON.stringify(formData),
                mode: 'no-cors', 
                headers: { 'Content-Type': 'text/plain' }
            })
            .then(response => {
                showSuccess();
            })
            .catch(error => {
                console.error('Error!', error.message);
                alert("Error submitting. Please check your internet connection.");
                btn.innerText = originalText;
                btn.disabled = false;
                btn.style.cursor = "pointer";
            });

            function showSuccess() {
                const form = document.getElementById('joinForm');
                const successMsg = document.getElementById('successMessage');

                gsap.to(form, { duration: 0.5, opacity: 0, y: -20, display: 'none', ease: "power2.in" });
                gsap.set(successMsg, { display: 'block', opacity: 0, y: 30 });
                gsap.to(successMsg, { duration: 0.8, opacity: 1, y: 0, delay: 0.5, ease: "power3.out" });
                
                document.querySelector('.article-hero').scrollIntoView({ behavior: 'smooth' });
            }
        }

        /* --- THEME & ANIMATIONS --- */
        const html = document.documentElement;
        function toggleTheme() {
            const current = html.getAttribute('data-theme');
            const next = current === 'dark' ? 'light' : 'dark';
            html.setAttribute('data-theme', next);
            const btn = document.getElementById('themeBtn');
            if(next === 'dark') {
                btn.classList.add('active'); btn.innerHTML = '<i class="fas fa-sun"></i> <span>LIGHT</span>';
            } else {
                btn.classList.remove('active'); btn.innerHTML = '<i class="fas fa-moon"></i> <span>DARK</span>';
            }
        }
        function toggleBlindMode() {
            html.classList.toggle('blind-mode');
            document.getElementById('blindBtn').classList.toggle('active');
        }

        gsap.registerPlugin(ScrollTrigger);
        gsap.utils.toArray('.gsap-reveal').forEach(elem => {
            gsap.from(elem, { scrollTrigger: { trigger: elem, start: "top 90%" }, y: 30, opacity: 0, duration: 1, ease: "power3.out" });
        });

        /* --- CANVAS --- */
        const canvas = document.getElementById('engineering-canvas');
        const ctx = canvas.getContext('2d');
        let w, h, nodes = [];
        const mouse = { x: null, y: null };

        function resize() { w = canvas.width = window.innerWidth; h = canvas.height = window.innerHeight; initNodes(); }
        function initNodes() {
            nodes = [];
            const count = window.innerWidth < 768 ? 40 : 80;
            for(let i=0; i<count; i++) nodes.push({ x: Math.random()*w, y: Math.random()*h, vx: (Math.random()-0.5), vy: (Math.random()-0.5), size: Math.random()*4+2 });
        }
        function animateCanvas() {
            ctx.clearRect(0, 0, w, h);
            const styles = getComputedStyle(document.body);
            if(styles.getPropertyValue('--canvas-display').trim() === 'none') { requestAnimationFrame(animateCanvas); return; }
            const nodeColor = styles.getPropertyValue('--canvas-node').trim();
            nodes.forEach(node => {
                node.x += node.vx; node.y += node.vy;
                if(node.x<0||node.x>w) node.vx*=-1; if(node.y<0||node.y>h) node.vy*=-1;
                ctx.fillStyle = nodeColor; ctx.fillRect(node.x-node.size/2, node.y-node.size/2, node.size, node.size);
            });
            requestAnimationFrame(animateCanvas);
        }
        window.addEventListener('mousemove', (e) => {
            mouse.x = e.clientX; mouse.y = e.clientY;
            // UPDATE: Move the custom cursor with the mouse
            gsap.to(document.getElementById('cursor-dot'), { x: e.clientX, y: e.clientY, duration: 0.1 });
        });
        window.addEventListener('mouseleave', () => { mouse.x = null; mouse.y = null; });
        window.addEventListener('resize', resize);
        resize(); animateCanvas();

        document.querySelectorAll('.hover-trigger').forEach(el => {
            el.addEventListener('mouseenter', () => document.body.classList.add('hover-active'));
            el.addEventListener('mouseleave', () => document.body.classList.remove('hover-active'));
        });
        document.querySelectorAll('.magnetic').forEach(el => {
            el.addEventListener('mousemove', (e) => {
                const rect = el.getBoundingClientRect();
                gsap.to(el, { x: (e.clientX - rect.left - rect.width/2)*0.3, y: (e.clientY - rect.top - rect.height/2)*0.3, duration: 0.3, ease: "power2.out" });
            });
            el.addEventListener('mouseleave', () => gsap.to(el, { x: 0, y: 0, duration: 1, ease: "elastic.out(1, 0.3)" }));
        });
    </script>
</body>
</html>
